# モザイクアート作成の手引き 2024年度改訂版

## 目次
- [モザイクアート作成の手引き 2024年度改訂版](#モザイクアート作成の手引き-2024年度改訂版)
  - [目次](#目次)
  - [注意事項](#注意事項)
  - [0. 使用するソフトの準備](#0-使用するソフトの準備)
  - [1. 画像の準備](#1-画像の準備)
    - [1-1. 画像をスキャン](#1-1-画像をスキャン)
      - [1-1-1. 原画が紙の場合](#1-1-1-原画が紙の場合)
      - [1-1-2. 画像がデータの場合](#1-1-2-画像がデータの場合)
    - [1-2. 画像をトリミング、リサイズ](#1-2-画像をトリミングリサイズ)
  - [2. bigart.exe を実行](#2-bigartexe-を実行)
    - [2-1. 画像を読み込み](#2-1-画像を読み込み)
    - [2-2. パレットデータを読み込み](#2-2-パレットデータを読み込み)
    - [2-3. モザイク化](#2-3-モザイク化)
  - [3. データを CSV/Excel に変換](#3-データを-csvexcel-に変換)
    - [3-1. setting.json を準備](#3-1-settingjson-を準備)
    - [3-2. MosaicData\_toExcel.exe を実行](#3-2-mosaicdata_toexcelexe-を実行)
  - [4. 完成したデータを確認](#4-完成したデータを確認)
  - [5. ページレイアウト(手動)](#5-ページレイアウト手動)
  - [6. 印刷](#6-印刷)


## 注意事項
- 作業はすべてWindows11のPCで行ってください。Windows 10でも可能ですが、ソフトが対応していなかったり、バグが発生したりすることがあります。
- 作業は1人でやらずに、全校制作部門で協力してやりましょう。パソコンができる人がいると心強いですが、任せっきりにならないように！
- 作業内で使用するソフトの「モザイク画データ_変換プログラム.exe」は自作プログラムのため不具合が発生することがあります。その場合には、[**README.md**](/README.md#contact) 内の **contact** までご連絡ください。



## 0. 使用するソフトの準備
https://github.com/TaichiOikawa/Mosaic-Art/releases

1. **MosaicData_toExcel.zip** をダウンロード
2. ダウンロードしたファイルを展開



## 1. 画像の準備
### 1-1. 画像をスキャン
#### 1-1-1. 原画が紙の場合
原画をコンビニなどでスキャンして取り込み。
- USBを忘れずに
- 原画よりも少し大きめのサイズを指定すること
- 必ず`jpeg`ファイルを指定すること
- 画質を400dpi以上にすると綺麗に取り込めます
- 原画はスキャンするサイズの中央あたりに置くと後でトリミングしやすいです
- 領収書を必ず印刷すること

#### 1-1-2. 画像がデータの場合
USB内に`jpeg`ファイルとして保存してもらう。<br>
それが難しい場合は生徒会側で`jpeg`ファイルに変換。

### 1-2. 画像をトリミング、リサイズ
1. 画像を選択し、右クリック → プログラムから開く →「ペイント」
2. 向きを揃える(赤四角)、余計な部分を切り取る(赤丸)
   ![img](/documents/img/paint_routate.png)
3. 「イメージ」→「サイズ変更と傾斜」(赤枠)をクリック。
   ![img](/documents/img/paint_size1.png)
4. 「ピクセル」を選択。赤枠内の中央のボタンが青くなっているか確認。
5. 水平・垂直を調整。目標は "水平: 630&emsp;垂直: 432"<br>
   以下のどちらかに合わせて、「OK」をクリック。
   1. **水平**を`630`にしたとき、**垂直**が`432`以上になる。
   2. **垂直**を`432`にしたとき、**水平**が`630`以上になる。
   ![img](/documents/img/paint_size2.png)
6. 赤丸のところをつかんで、大きさ(赤矢印)のところが`630 × 432px`になるように調整します。
   ![img](/documents/img/paint_size3.png)
7. ファイル → 名前を付けて保存 → JPEG画像 で保存。



## 2. bigart.exe を実行
bigart.exeを起動
### 2-1. 画像を読み込み
1. 「画像読込」をクリック → 先ほど保存した画像を選択
2. 1列の枚数: 35&emsp;1段の枚数: 24&emsp;&emsp;に変更

![img](/documents/img/bigart_load.png)


### 2-2. パレットデータを読み込み
1. 「モザイク化」をクリック
2. 「色呼出」→「color.pal」を選択

![img](/documents/img/bigart_call.png)


### 2-3. モザイク化
1. 「実行」→「保存」(名前をつけて)



## 3. データを CSV/Excel に変換
### 3-1. setting.json を準備
`settings.json`を選択し、右クリック、メモ帳で開く。それぞれ値を編集します。**値はすべて`"`で囲ってください。**

- ClassNames
  - クラス名を入力してください。クラスとクラスの間は`,`を入れてください。
- PiecesPerOrigami
  - 1枚の折り紙から作れるピースの数を入力してください。15*15の折り紙で1cm角とすると225となります。
- BlocksPerClass
  - 1クラスに配るモザイク画のブロック数を入力してください。3学年すべてが6クラスで、bigart.exeから出力したデータが18*18ブロックだった場合は18となります。
- ReplaceWhiteCharacter
  - 台紙内の「白」の文字を空文字に置換するか指定します。`True`だと有効、`False`ふだと無効です。
- Excel
  - width
    - セルの列幅です。**変更しないでください。**
  - height
    - セルの行幅です。**変更しないでください。**
  - margin_top, margin_bottom, margin_left, margin_right
    - 上下左右の余白です。**変更しないでください。**
  - margin_header, margin_footer
    - ヘッダーとフッターの余白です。**変更しないでください。**
  - print_grid_line
    - 枠線を印刷するかしないかを指定します。する場合は`True`、しない場合は`False`と入力してください。`True`のままで大丈夫です。

![img](/documents/img/settings_text.png)


### 3-2. MosaicData_toExcel.exe を実行
bigart.exeで出力したデータ(.txtファイル)をexeファイルがあるフォルダーに移動してから実行してください。フォルダーの中身が以下のようになっていれば大丈夫です。

```
.
├── bigart21
├── license
├── color.pal
├── settings.json
├── モザイクデータ.txt (ファイル名はなんでもOK)
└── モザイク画データ_変換プログラム.exe
```


<span style="color: orangered;">このソフトは起動まで時間がかかります。</span>これは仕様ですので、操作せずにお待ちください。明らかに起動しない際はご連絡ください。

あとは、指示通り操作していけばcsv/excelデータがoutputフォルダーに出力されます。<br>
※「合計ピクセルが記載されている行」とは、bigartから出力されたテキストファイルの最終行(だいたい2行)に記載されている使用している色の合計が書かれている部分です。<span style="color: orangered;">ココを正しく指定しないと計算結果がずれます。</span>

![img](/documents/img/mosaicart-program.png)


## 4. 完成したデータを確認
完成したexcelデータを開いてください。

1. 画面右下の真ん中をクリックしてページレイアウト表示にします。

![img](/documents/img/excel_page_layout_mode.png)

2. シートを全選択し、列の幅・行の幅を0.98cmに指定 (すでになっている場合は変更しなくてOK)

3. 「ページレイアウト」→「サイズ」→「JIS B4」

4. シートが右にはみ出していないか、シートの終わりが画像のようになるか確認

![img](/documents/img/excel_layout_sample.png)

5. 4がOKなら [6. 印刷](#6-印刷) へ
6. 4がずれている場合は [5. ページレイアウト(手動)](#5-ページレイアウト手動) へ


## 5. ページレイアウト(手動)
ページレイアウトが自動で設定できなかった場合はこの手順通りに手動で設定してください。<br>
MosaicData_toExcel.exeから出力された状態のExcelファイルから作業を始めます。

1. 画面右下の真ん中をクリックしてページレイアウト表示にします。

![img](/documents/img/excel_page_layout_mode.png)

2. シートを全選択し、列の幅・行の幅を0.98cmに指定 (すでになっている場合は変更しなくてOK)
3. 「ページレイアウト」→「印刷の向き」→「横」
4. 「ページレイアウト」→「サイズ」→「JIS B4」
5. 「ページレイアウト」→「余白」→「ユーザー設定の余白(A)」&emsp;画像のように設定。
> [!WARNING]
> `JIS B4` がない場合は、「ファイル」→「印刷」→ 「プリンター」→ `Adobe PDF` を指定してください。

![img](/documents/img/excel_margin_setting.png)

1. 「ページレイアウト」→「シートのオプション」&emsp;画像のように設定

![img](/documents/img/excel_layout_option.png)

7. シートが右にはみ出していないか、シートの終わりが画像のようになるか確認

![img](/documents/img/excel_layout_sample.png)

8. OKなら [6. 印刷](#6-印刷) へ


## 6. 印刷
1. 「ファイル」→「印刷」

2. プリンター: Adobe PDF&emsp;→「印刷」

保存したPDFに間違いがないか確認したら、担当の先生に印刷してもらいましょう。<br>
(事前にお願いしておくこと)
